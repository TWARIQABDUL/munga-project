<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

    <title>Mumnga-project</title>
</head>

<body>

    <header id="header">
        <nav>
            <h1>traver</h1>
            <ul>
                <li><a href="#services">Service</a></li>
                <li><a href="#department">Department</a></li>
                <li><a href="#news-lette">Newsleter</a></li>
                <li><a href="#footer">Site Map</a></li>
            </ul>
            <div class="buttons_auth">
                <button id="register">Signup</button>
                <button class="mobile-menu" id="menu"> <img src="images/icon-menu.svg" alt=""></button>
            </div>
        </nav>
    </header>
    <div class="scrol-reminder" id="scrol">
        <!-- Hey you're taking to long -->
    </div>
    <div class="mobile-menu-container ">
        <button class="close-menu" id="close"><img src="images/icon-close.svg" alt=""></button>

        <!-- <button class=""> <img src="images/icon-close.svg" alt=""></button> -->
        <ul>
            <li><a href="/about.html">Home</a></li>
            <li><a href="/about.html">About Us</a></li>
            <li><a href="contactus.html">Contact Us</a></li>
            <!-- <li><a href="#footer">Site Map</a></li> -->
        </ul>
    </div>
    <main>
        <div class="back-button" id="back-button">
            <img src="images/back.svg" alt="">
        </div>
        <section class="hero">
            <div class="hero-content">
                <div class="text-container">
                    <h1>Welcome to Traver</h1>
                    <h2 id="trael-text"></h2>
                    <p>Built Wicket longer admire do barton vanity itself do in it. Preferred to sportsmen it engrossed
                        listening. Park gate sell they west hard for the.</p>
                    <div class="buttons">
                        <button class="more">Find out more</button>
                        <button class="play"><span><img src="images/poly.svg" alt=""></span> Play Demo</button>
                    </div>
                </div>
                <div class="image-container">
                    <img src="images/hero-image.png" alt="Hero Image">
                </div>

            </div>

        </section>
        <section class="services" id="services">
            <div class="title">
                <h3>CATEGORY</h3>
                <p>We Offer Best Services</p>
            </div>
            <div class="container">

                <div class="service-cards">
                    <!-- dynamic Card -->
                </div>
            </div>
        </section>

        <!-- Top selling -->

        <section class="services" id="department">
            <div class="title">
                <h3>Top Selling</h3>
                <p>Top Destinations</p>
            </div>
            <div class="filter">
                <select name="" id="locationFilter">
                    <option value="price">Fitler By Price</option>
                    <option value="location">Fitler By Location</option>
                    <option value="temperature">Fitler By Temprature</option>
                </select>
                <input type="text" placeholder="Search by city" id="search-input">
            </div>
            <div class="card-container">

                <div class="destination-cards">

                    <!-- dynamic location -->

                </div>
            </div>
        </section>
        <section class="newsletter" id="news-lette">
            <div class="newsletter-content">
                <h3>Subscribe to our Newsletter</h3>
                <p>Get the latest news and updates about our services.</p>
                <form action="#" method="post">
                    <div class="email">
                        <img src="images/email.svg" alt="">
                        <input type="email" placeholder="Enter your email" required>
                    </div>
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </section>

        
    </main>
    <footer id="footer">
        <div class="company">
            <h3>Traver</h3>
            <p>Book your trip in minute, get full
                Control for much longer..</p>

        </div>
        <div class="links">
            <h3>Company</h3>
            <ul>
                <li><a href="about.html">About</a></li>
                <li><a href="index.html">Career</a></li>
                <li><a href="contactus.html">Mobile</a></li>
            </ul>
        </div>
        <div class="contact">
            <h3>Contact</h3>
            <ul>
                <li><a href="">Help/FAQ</a></li>
                <li><a href="">Press</a></li>
                <li><a href="">Affiliates</a></li>
            </ul>
        </div>
        <div class="more-stuf">
            <h3>More</h3>
            <ul>
                <li><a href="#">Airline Fees</a></li>
                <li><a href="#">Airline</a></li>
                <li><a href="#">Low fare tips</a></li>
            </ul>
        </div>
    </footer>
    <script src="js/main.js"></script>
    <script>
        const destination_cards = document.querySelector(".destination-cards");
        const service_cards = document.querySelector(".service-cards");
        let locationData = []
        let scrolling = 0
        const filterData = document.getElementById("locationFilter")
        const search_input = document.getElementById("search-input")


        window.addEventListener("scroll", () => {
            document.getElementById("scrol").innerHTML = ""
            document.getElementById("scrol").style.display = 'none'

            scrolling = 1
            // console.log("begin scrolling");


        })
        window.addEventListener("mousemove", () => {
            document.getElementById("scrol").innerHTML = ""
            document.getElementById("scrol").style.display = 'none'

            scrolling = 1
            // console.log("begin scrolling");


        })
        let timer = setInterval(() => {
            if (scrolling < 1) {
                // console.log("I am going to exit please scrol me");
                document.getElementById("scrol").innerHTML = "what are you still doing here"
                document.getElementById("scrol").style.display = 'block'

            }

            scrolling = 0

        }, 3000)

        // console.log(scrolling);
        const back_button = document.getElementById('back-button');
        const menu = document.getElementById('menu');
        const register = document.getElementById("register");
        const movingText = "Travel, enjoy and live a new and full life".split("")
        const travel_text = document.getElementById("trael-text")

        let count = 0


        for (let index = 0; index < movingText.length; index++) {
            const timeOut = setTimeout(() => {
                if (movingText[index] === " ") {
                    travel_text.append(" ")
                }
                travel_text.append(`${movingText[index]}`)
                // console.log(movingText[index]);
            }, 100 * index)
        }


        movingText.forEach((text) => {

        })

        // console.log(movingText);
        register.addEventListener('click', () => {
            window.location.href = "login.html"
        })
        back_button.addEventListener('click', () => {
            window.location.href = "#";
        });
        const addServiceCard = (content) => {
            const elem = document.createElement("div")
            elem.classList.add("card")

            elem.innerHTML = `
            <img src="${content.icon}">
            <h3>${content.title}</h3>
            <p>${content.body}.</p>
        `

            service_cards.append(elem);
        }
        const categories = [
            {
                icon: "images/satellite.svg",
                title: "Calculated Weather",
                body: "Built Wicket longer admire do barton vanity itself do in it"
            },
            {
                icon: "images/plane.svg",
                title: "Best Flights",
                body: "Engrossed listening. Park gate sell they west hard for the."
            },
            {
                icon: "images/customization.svg",
                title: "Customizatio",
                body: "We deliver outsourced aviation services for military customers."
            }
        ]
        const Locations = [
            {
                icon: "images/dest1.png",
                location: "Kigali",
                price: 100,
                temp: 0,
                weather: null,
                humidity: null
            },
            {
                icon: "images/dest2.png",
                location: "Kampala",
                price: 360,
                temp: 0,
                weather: null
            },
            {
                icon: "images/dest1.png",
                location: "London",
                price: 134,
                temp: 0,
                weather: null
            },
            {
                icon: "images/dest1.png",
                location: "London",
                price: 500,
                temp: 0,
                weather: null
            },
        ]
        categories.map(content => addServiceCard(content))

        const addLocationCard = (content) => {
            const elem = document.createElement("div")
            elem.classList.add("card")
            elem.dataset.price = content.price
            elem.dataset.location = content.location

            elem.innerHTML = `
                <img src="${content.icon}">
                <div class="destination-info">
                    <p>${content.location}<span>$${content.price}</span></p>
                    <p>Humidity<span>${content.humidity} ðŸŒ¡</span></p>
                    <p>Curentntly<span>${(content.humidity > 80) ? " rainy &#127784;" : "sunny &#9728;"}</span></p>
                    <p>temp<span>${content.temp} ðŸŒ¡</span></p>
                </div>
            `
            destination_cards.append(elem);
        }


        const fetchWeatherInfo = async (locatioList) => {
            let info = locatioList.map(location => {
                fetch(`https://api.openweathermap.org/data/2.5/weather?q=${location.location}&appid=d84e490083cc222cddc06eaa7e8119f6`)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error("Something went wrong here");
                        }
                        // console.log(response);
                        return response.json()
                    })
                    .then(respons => {
                        location.weather = respons.main.temp;
                        location.humidity = respons.main.humidity
                        location.temp = Math.round(respons.main.temp - 2)
                        // console.log("some",respons);
                        // return respons.main
                        addLocationCard(location);
                        locationData.push(location)
                      
                    }).catch(e=>{
                        console.error("Fetch problem detected", e)
                        
                    })
            })
        }
        fetchWeatherInfo(Locations)
        search_input.addEventListener("input", (e) => {
            const searchTerm = e.target.value.toLowerCase();

            const filtered = locationData.filter((loc) =>
                loc.location.toLowerCase().includes(searchTerm)
            );

            destination_cards.innerHTML = ""; // clear previous cards
            filtered.forEach(loc => addLocationCard(loc));
        });
        // getting the filter info
        filterData.addEventListener('change', (e) => {

            destination_cards.innerHTML = ""

            switch (e.target.value) {
                case "price":
                    const sortedByPrice = [...locationData].sort((a, b) => a.price - b.price);
                    sortedByPrice.forEach(loc => addLocationCard(loc));
                    break;

                case "temperature":
                    const sortedByTemp = [...locationData].sort((a, b) => a.temp - b.temp);
                    sortedByTemp.forEach(loc => addLocationCard(loc));
                    console.log(sortedByTemp);

                    break;
                case "location":
                    const sortedByLocation = [...locationData].sort((a, b) => a.location - b.location);
                    sortedByLocation.forEach(loc => addLocationCard(loc));
                    console.log(sortedByLocation);
                default:
                    break
            }
        })
        // console.log("resolved");
    </script>
</body>

</html>